Ищу минимальное расстояние, как минимум функции: |dr| = r1 - r2, где r1, r2 - радиус-векторы точки на первом и втором отрезке соответственно.

Запишем r1 = r01 + a*t1, r2 = r02 + b*t2, где a, b - напрвляющие векторы отрезков, t1, t2 - числа в интервале от 0 до 1.

dr = r01 - r02 + a*t1 - b*t2

(dr, dr) = (r01 - r02, r01 - r02) + t1 * (r01 - r02, a) - t2 * (r01 - r02, b) - t * t * (a, b) + t1 * t1 * (a, a) + t2 * t2 (b, b)

Чтобы найти минимум этой функции, сначала найдем точки экстремума. Обнулив частную производную сначала по t1, затем по t2, получим систему из двух уравнений. Решение системы будет кандидатом в минимум расстояния между отрезками (только если решение удовлетворяет условию 0 <= t1, t2 <= 1).

Кроме того, проверим граничные случаи. Подставляя в функцию заданное t1 или t2, равное 0 или 1, получим всего четыре уравнения, из которых легко найти расстояние от соответствующей граничной точки отрезка до другого отрезка. Эти четыре расстояния - тоже кандидаты в минимум (опять таки, только если решение удовлетворяет условию).

Из матана можно понять, что минимум функции - одно из вышеперечисленных значений.
